# /gitcommit

*自动分析当前项目的代码改动，分批进行代码提交，采用行业规范的提交消息格式*

## 功能特性

### 🔍 智能代码分析
- 自动检测所有未提交的代码改动
- 智能分组相关文件改动
- 分析代码变更的类型和影响范围

### 📝 规范提交消息
- 使用行业标准的提交消息格式
- 支持常见提交类型：feat、fix、refactor、docs、style、test、chore
- 自动生成有意义的提交描述

### 🔄 分批提交策略
- 智能分批处理大量文件改动
- 保持提交的逻辑性和可读性
- 避免单次提交包含过多不相关的更改

### 🎯 提交类型识别
- **feat**: 新功能
- **fix**: 错误修复
- **refactor**: 代码重构
- **docs**: 文档更新
- **style**: 代码格式调整
- **test**: 测试相关
- **chore**: 构建过程或辅助工具变动

## 使用方法

```bash
# 基本用法
/gitcommit

# 指定提交批次大小
/gitcommit --batch-size=5

# 指定提交消息前缀
/gitcommit --prefix="优化"
```

## 执行流程

### 自动加载项目上下文：
@/CLAUDE.md
@/docs/ai-context/project-structure.md
@/docs/ai-context/docs-overview.md

### 第 1 步：检查 Git 状态
- 验证当前目录是否为 Git 仓库
- 检查是否有未提交的更改

### 第 2 步：分析文件改动
- 获取所有未提交的文件列表
- 分析文件类型和修改内容
- 智能识别提交类型

### 第 3 步：智能分组
- 按文件类型分组（代码、文档、配置、测试等）
- 按目录结构分组
- 按修改类型分组

### 第 4 步：生成提交消息
- 根据文件组自动生成规范的提交消息
- 格式：`<type>(<scope>): <description>`

### 第 5 步：分批提交
- 按分组结果执行分批提交
- 每次提交都有明确的意图和范围

## 输出示例

```
🔍 开始分析代码改动...

📊 发现 8 个未提交的文件：
- src/api/auth.js (修改)
- src/api/user.js (新增)
- docs/api.md (修改)
- test/auth.test.js (新增)
- package.json (修改)
- README.md (修改)
- .gitignore (修改)
- src/utils/helpers.js (修改)

📋 智能分组结果：

🎯 第 1 组 - API 功能 (3 个文件)
- src/api/auth.js
- src/api/user.js
- test/auth.test.js
💬 提交消息: feat(api): 新增用户管理和认证功能

📚 第 2 组 - 文档更新 (2 个文件)
- docs/api.md
- README.md
💬 提交消息: docs: 更新 API 文档和项目说明

⚙️ 第 3 组 - 配置和工具 (3 个文件)
- package.json
- .gitignore
- src/utils/helpers.js
💬 提交消息: chore: 更新依赖配置和工具函数

🚀 开始执行分批提交...

✅ 第 1 次提交完成: feat(api): 新增用户管理和认证功能
✅ 第 2 次提交完成: docs: 更新 API 文档和项目说明
✅ 第 3 次提交完成: chore: 更新依赖配置和工具函数

🎉 所有提交完成！共提交 3 个批次，包含 8 个文件。
```

## 配置选项

### 批次大小
- `--batch-size=N`: 指定每批提交的文件数量
- 默认值: 自动根据文件类型和相关性确定

### 提交前缀
- `--prefix="文本"`: 为所有提交消息添加前缀
- 默认值: 无前缀

### 提交类型
- `--type=feat|fix|refactor|...`: 强制使用指定的提交类型
- 默认值: 自动分析确定

## 相关命令

- `/code-review` - 代码质量审查
- `/refactor` - 代码重构
- `/update-docs` - 文档更新

## 注意事项

1. **备份重要更改**: 在执行批量提交前，建议先备份重要更改
2. **审查提交消息**: 自动生成的提交消息可能需要人工调整
3. **测试提交结果**: 提交后建议运行测试确保功能正常
4. **分支保护**: 如果启用了分支保护，可能需要手动合并